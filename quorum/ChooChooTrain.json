{"name":"ChooChooTrain","description":"","version":"1.0","culture":"en-GB","modifiedTime":"2024-11-01T11:40:21.6893891+00:00","ppdf:outputFileFormat":"Csv","pbi:mashup":{"fastCombine":true,"allowNativeQueries":false,"queriesMetadata":{"ExcelSpreadSheetPath":{"queryId":"bf4d4bc9-042c-41d3-a510-c64e069f2206","queryName":"ExcelSpreadSheetPath","queryGroupId":"6abf0812-58eb-414a-838e-f41cb5635848"},"parmFirsttPartOfUrl":{"queryId":"67b5c50c-e2ff-4631-8127-a0270b7ce712","queryName":"parmFirsttPartOfUrl","queryGroupId":"6abf0812-58eb-414a-838e-f41cb5635848"},"fxGetTodaysDate":{"queryId":"7864347e-37da-4eab-a41f-b63513518f11","queryName":"fxGetTodaysDate","queryGroupId":"6abf0812-58eb-414a-838e-f41cb5635848"},"CurrentTimePlusOne":{"queryId":"4d84a05d-3890-47d8-a5e0-180085d51d11","queryName":"CurrentTimePlusOne","queryGroupId":"6abf0812-58eb-414a-838e-f41cb5635848","loadEnabled":true},"TodaysDate":{"queryId":"98fda861-d87f-43e8-99d3-bcb1e49b9cbe","queryName":"TodaysDate","queryGroupId":"6abf0812-58eb-414a-838e-f41cb5635848","loadEnabled":true},"TrainServicesNextHourV2":{"queryId":"80c6c4e6-4199-4704-bc61-9cc7f531cb10","queryName":"TrainServicesNextHourV2","queryGroupId":"f46495b9-7e51-46e3-9c6c-f2bef65af4e5"},"ServicesNextHrSpreadsheet":{"queryId":"d2ebfb24-c687-4d1f-acef-6a1e80f6cbf0","queryName":"ServicesNextHrSpreadsheet","queryGroupId":"05c9da4c-0131-41ab-a8d1-34033956358e","loadEnabled":true},"ServicesNextHrSpreadsheetViaStationsV2":{"queryId":"0088166c-3555-4ed1-bbd4-bda81a2d1686","queryName":"ServicesNextHrSpreadsheetViaStationsV2","queryGroupId":"05c9da4c-0131-41ab-a8d1-34033956358e","loadEnabled":true},"Station_attributes":{"queryId":"7deb4ad5-db82-471e-8412-d8393f6cf5b5","queryName":"Station_attributes","queryGroupId":"bc4a2699-cbfd-4fd8-b491-4f097ea333f6","loadEnabled":true},"JourneyStationsV2":{"queryId":"66184ab8-6b0a-4057-b545-f47d8c68977f","queryName":"JourneyStationsV2","queryGroupId":"f46495b9-7e51-46e3-9c6c-f2bef65af4e5"}},"document":"section Section1;\r\nshared ExcelSpreadSheetPath = \"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/TrainServices.xlsx\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type text];\r\nshared parmFirsttPartOfUrl = \"https://api.rtt.io/api/v1/json/service/\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type text];\r\nshared fxGetTodaysDate = let\n    Source = () => let\n      Source = \n        Text.From(Date.Year(DateTime.LocalNow()))\n        & \"/\"\n        & Text.End(\"0\" & Text.From(Date.Month(DateTime.LocalNow())), 2)\n        & \"/\"\n        & Text.End(\"0\" & Text.From(Date.Day(DateTime.LocalNow())), 2),        \n        #\"Converted to List\" = {Source},\n        #\"Converted to Table\" = Table.FromList(#\"Converted to List\", Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n        #\"Renamed Columns\" = Table.RenameColumns(#\"Converted to Table\",{{\"Column1\", \"Date\"}})\n    in\n      #\"Renamed Columns\"\nin\n    Source;\r\nshared CurrentTimePlusOne = let\r\n  CurrentTime = DateTime.LocalNow() as datetime,\r\n  ExtractedTime = Time.From(CurrentTime),\r\n  ExtractedTimePlusOne = ExtractedTime + #duration(0, 1, 0, 0),\r\n  #\"Extracted Time\" = Time.From(ExtractedTimePlusOne),\r\n  #\"Extracted time 1\" = DateTime.Time(#\"Extracted Time\"),\r\n  #\"Convert to table\" = Table.FromValue(#\"Extracted time 1\")\r\nin\r\n  #\"Convert to table\";\r\nshared TodaysDate = let\r\n  Source = Text.From(Date.Year(DateTime.LocalNow()))\n    & \"/\"\n    & Text.End(\"0\" & Text.From(Date.Month(DateTime.LocalNow())), 2)\n    & \"/\"\n    & Text.End(\"0\" & Text.From(Date.Day(DateTime.LocalNow())), 2),\r\n  #\"Converted to List\" = {Source},\r\n  #\"Converted to Table\" = Table.FromList(#\"Converted to List\", Splitter.SplitByNothing(), null, null, ExtraValues.Error),\r\n  #\"Renamed Columns\" = Table.RenameColumns(#\"Converted to Table\", {{\"Column1\", \"Date\"}}),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Renamed Columns\", {{\"Date\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"Date\", null}})\r\nin\r\n  #\"Replace errors\";\r\nshared TrainServicesNextHourV2 = let\n  Source = (StartStation as text, DestinationStation as text) =>\n    //\n    //This is URL soure\n    // \n    // StartStation = \"EDB\",\n    // DestinationStation = \"GLQ\",\n    let\n      //Get the current time\n      CurrentTime = DateTime.LocalNow() as datetime, \n      ExtractedTime = Time.From(CurrentTime), \n      //now add one hour to the current time\n      ExtractedTimePlusOne = ExtractedTime + #duration(0, 1, 0, 0), \n      #\"Extracted Time\" = Time.From(ExtractedTimePlusOne), \n\n    BaseURL = \"https://api.rtt.io/api/v1/json/search/\", \n\n      RealTimeURLStartDestinationPart1 = StartStation, \n      RealTimeURLStartDestinationPart2 = RealTimeURLStartDestinationPart1 & \"/to/\", \n      RealTimeURLStartDestination = RealTimeURLStartDestinationPart2 & DestinationStation, \n      //Source = Json.Document(Web.Contents(\"https://api.rtt.io/api/v1//json/search/EDB/to/GLQ\")), \n\n     URL = Web.Contents(BaseURL, [RelativePath = RealTimeURLStartDestination]),\n     Source = Json.Document(URL),\n\n      // Source = Json.Document(Web.Contents(RealTimeURLStartDestination)), \n      // Source = Json.Document(Web.Contents(\"https://api.rtt.io/api/v1/json/search/EDB/to/GLQ\")), \n      \n      \n      #\"Converted to Table\" = Table.FromRecords({Source}), \n      #\"Expanded location\" = Table.ExpandRecordColumn(\n        #\"Converted to Table\", \n        \"location\", \n        {\"name\", \"crs\", \"tiploc\", \"country\", \"system\"}, \n        {\"location.name\", \"location.crs\", \"location.tiploc\", \"location.country\", \"location.system\"}\n      ), \n      #\"Expanded filter\" = Table.ExpandRecordColumn(\n        #\"Expanded location\", \n        \"filter\", \n        {\"destination\"}, \n        {\"filter.destination\"}\n      ), \n      #\"Expanded filter.destination\" = Table.ExpandRecordColumn(\n        #\"Expanded filter\", \n        \"filter.destination\", \n        {\"name\", \"crs\", \"tiploc\", \"country\", \"system\"}, \n        {\n          \"filter.destination.name\", \n          \"filter.destination.crs\", \n          \"filter.destination.tiploc\", \n          \"filter.destination.country\", \n          \"filter.destination.system\"\n        }\n      ), \n      #\"Expanded services\" = Table.ExpandListColumn(#\"Expanded filter.destination\", \"services\"), \n      #\"Expanded services1\" = Table.ExpandRecordColumn(\n        #\"Expanded services\", \n        \"services\", \n        {\n          \"locationDetail\", \n          \"serviceUid\", \n          \"runDate\", \n          \"trainIdentity\", \n          \"runningIdentity\", \n          \"atocCode\", \n          \"atocName\", \n          \"serviceType\", \n          \"isPassenger\"\n        }, \n        {\n          \"services.locationDetail\", \n          \"services.serviceUid\", \n          \"services.runDate\", \n          \"services.trainIdentity\", \n          \"services.runningIdentity\", \n          \"services.atocCode\", \n          \"services.atocName\", \n          \"services.serviceType\", \n          \"services.isPassenger\"\n        }\n      ), \n      #\"Expanded services.locationDetail\" = Table.ExpandRecordColumn(\n        #\"Expanded services1\", \n        \"services.locationDetail\", \n        {\"realtimeDeparture\", \"platform\"}, \n        {\"realtimeDeparture\", \"platform\"}\n      ), \n      #\"Removed Other Columns\" = Table.SelectColumns(\n        #\"Expanded services.locationDetail\", \n        {\n          \"location.name\", \n          \"filter.destination.name\", \n          \"realtimeDeparture\", \n          \"platform\", \n          \"services.serviceUid\"\n        }\n      ), \n      #\"Changed Type\" = Table.TransformColumnTypes(\n        #\"Removed Other Columns\", \n        {{\"realtimeDeparture\", type time}}\n      )\n      // , \n    //   #\"Filtered Rows\" = Table.SelectRows(\n    //     #\"Changed Type\", \n    //     each [realtimeDeparture] < #\"Extracted Time\"\n    //   )\n    // in\n    //   #\"Filtered Rows\"\n    in #\"Changed Type\"\nin\n  Source;\r\nshared ServicesNextHrSpreadsheet = let\r\n  Source = Excel.Workbook(Web.Contents(ExcelSpreadSheetPath), null, true),\r\n  Stations_Sheet = Source{[Item = \"Stations\", Kind = \"Sheet\"]}[Data],\r\n  #\"Promoted Headers\" = Table.PromoteHeaders(Stations_Sheet, [PromoteAllScalars = true]),\r\n  #\"Invoked Custom Function\" = Table.AddColumn(#\"Promoted Headers\", \"TrainServicesNextHourV2\", each TrainServicesNextHourV2([StartStation], [#\"DestinationStation \"])),\r\n  #\"Expanded TrainServicesNextHour\" = Table.ExpandTableColumn(#\"Invoked Custom Function\", \"TrainServicesNextHourV2\", {\"location.name\", \"filter.destination.name\", \"realtimeDeparture\", \"platform\", \"services.serviceUid\"}, {\"location.name\", \"filter.destination.name\", \"realtimeDeparture\", \"platform\", \"services.serviceUid\"}),\r\n  #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded TrainServicesNextHour\", {{\"filter.destination.name\", \"Destination\"}, {\"location.name\", \"Start\"}}),\r\n  // some services do not run at certain times or on certain days\r\n  #\"Start = null\" = Table.SelectRows(#\"Renamed Columns\", each [Start] <> null),\r\n  #\"Added Index\" = Table.AddIndexColumn(#\"Start = null\", \"Index\", 1, 1, Int64.Type),\r\n  #\"Filtered rows\" = Table.SelectRows(#\"Added Index\", each [platform] <> null),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Filtered rows\", {{\"StartStation\", type text}, {\"DestinationStation \", type text}, {\"Start\", type text}, {\"Destination\", type text}, {\"realtimeDeparture\", type text}, {\"platform\", type text}, {\"services.serviceUid\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"StartStation\", null}, {\"DestinationStation \", null}, {\"Start\", null}, {\"Destination\", null}, {\"realtimeDeparture\", null}, {\"platform\", null}, {\"services.serviceUid\", null}}),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Replace errors\", {{\"DestinationStation \", \"DestinationStation\"}})\r\nin\r\n  #\"Renamed columns 1\";\r\nshared ServicesNextHrSpreadsheetViaStationsV2 = let\r\n  Source = ServicesNextHrSpreadsheet,\r\n  // ------------------------------------------------------------------------\r\n  parmDate = TodaysDate,\r\n  parmURL = parmFirsttPartOfUrl,\r\n  // ------------------------------------------------------------------------\r\n  AddedparmDate = Table.AddColumn(Source, \"Custom\", each parmDate),\r\n  #\"Removed Other Columns\" = Table.SelectColumns(AddedparmDate, {\"Start\", \"Destination\", \"realtimeDeparture\", \"platform\", \"services.serviceUid\", \"Index\", \"Custom\"}),\r\n  ExpandedTodaysDate = Table.ExpandTableColumn(#\"Removed Other Columns\", \"Custom\", {\"Date\"}, {\"TodaysDate\"}),\r\n  AddedparmURL = Table.AddColumn(ExpandedTodaysDate, \"URL\", each parmURL),\r\n  #\"Added Custom\" = Table.AddColumn(AddedparmURL, \"relPath\", each [services.serviceUid] & \"/\" & [TodaysDate]),\r\n  #\"Invoked Custom Function\" = Table.AddColumn(#\"Added Custom\", \"Stations\", each JourneyStationsV2([relPath])),\r\n  #\"Expanded Stations\" = Table.ExpandTableColumn(#\"Invoked Custom Function\", \"Stations\", {\"crs\", \"platform\", \"Departure\", \"StationOrder\"}, {\"crs\", \"platform.1\", \"Departure\", \"StationOrder\"}),\r\n  // Join to the table that contains all the station names\r\n  #\"Left Join to Station Attributes Table\" = Table.NestedJoin(#\"Expanded Stations\", {\"crs\"}, Station_attributes, {\"Three Letter Code\"}, \"table_6329_station_attributes_for_all_mainline_stations_in_Great_Britain\", JoinKind.LeftOuter),\r\n  station_attributes = Table.ExpandTableColumn(#\"Left Join to Station Attributes Table\", \"table_6329_station_attributes_for_all_mainline_stations_in_Great_Britain\", {\"Station name\"}, {\"Station\"}),\r\n  #\"Renamed Columns\" = Table.RenameColumns(station_attributes, {{\"realtimeDeparture\", \"StationDeparture\"}}),\r\n  #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\", {{\"StationDeparture\", type time}, {\"Departure\", type time}, {\"StationOrder\", Int64.Type}}),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Changed Type\", {{\"TodaysDate\", type text}, {\"URL\", type text}, {\"relPath\", type text}, {\"crs\", type text}, {\"platform.1\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"TodaysDate\", null}, {\"URL\", null}, {\"relPath\", null}, {\"crs\", null}, {\"platform.1\", null}})\r\nin\r\n  #\"Replace errors\";\r\nshared Station_attributes = let\r\n  Source = Excel.Workbook(Web.Contents(\"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/table-6329-station-attributes-for-all-mainline-stations.xlsx\"), null, true),\r\n  table_6329_station_attributes_for_all_mainline_stations_in_Great_Britain_Table = Source{[Item = \"table_6329_station_attributes_for_all_mainline_stations_in_Great_Britain\", Kind = \"Table\"]}[Data],\r\n  #\"Choose columns\" = Table.SelectColumns(table_6329_station_attributes_for_all_mainline_stations_in_Great_Britain_Table, {\"Station name\", \"Three Letter Code\"}),\r\n  #\"Removed duplicates\" = Table.Distinct(#\"Choose columns\", {\"Three Letter Code\"}),\r\n  #\"Trimmed text\" = Table.TransformColumns(#\"Removed duplicates\", {{\"Three Letter Code\", each Text.Trim(Text.From(_)), type nullable text}}),\r\n  #\"Removed duplicates 1\" = Table.Distinct(#\"Trimmed text\", {\"Three Letter Code\"}),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Removed duplicates 1\", {{\"Station name\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"Station name\", null}})\r\nin\r\n  #\"Replace errors\";\r\nshared JourneyStationsV2 = let\n  Source = (relPath as text) =>\n      let\n\n\n//to call web api's it is required to construct the URL differently\n  BaseURL = parmFirsttPartOfUrl, //https://api.rtt.io/api/v1/json/service/\n  // RelPath = \"P78975/2024/07/22\",\n\n  URL = Web.Contents(BaseURL, [RelativePath = relPath]),\n\n  SourceDoc = Json.Document(URL),\n\n// SourceDoc = Json.Document(Web.Contents(relURL)), \n\n  #\"Converted to Table\" = Record.ToTable(SourceDoc), \n  Value = #\"Converted to Table\"{12}[Value], \n  //Value = #\"Converted to Table\"{0}[Value], \n  #\"Converted to Table1\" = Table.FromList(\n    Value, \n    Splitter.SplitByNothing(), \n    null, \n    null, \n    ExtraValues.Error\n  ), \n  #\"Expanded Column2\" = Table.ExpandRecordColumn(\n    #\"Converted to Table1\", \n    \"Column1\", \n    {\n      \"realtimeActivated\", \n      \"tiploc\", \n      \"crs\", \n      \"description\", \n      \"gbttBookedDeparture\", \n      \"origin\", \n      \"destination\", \n      \"isCall\", \n      \"isPublicCall\", \n      \"realtimeDeparture\", \n      \"realtimeDepartureActual\", \n      \"platform\", \n      \"platformConfirmed\", \n      \"platformChanged\", \n      \"line\", \n      \"lineConfirmed\", \n      \"displayAs\", \n      \"gbttBookedArrival\", \n      \"realtimeArrival\", \n      \"realtimeArrivalActual\", \n      \"realtimeGbttArrivalLateness\"\n    }, \n    {\n      \"realtimeActivated\", \n      \"tiploc\", \n      \"crs\", \n      \"description\", \n      \"gbttBookedDeparture\", \n      \"origin\", \n      \"destination\", \n      \"isCall\", \n      \"isPublicCall\", \n      \"realtimeDeparture\", \n      \"realtimeDepartureActual\", \n      \"platform\", \n      \"platformConfirmed\", \n      \"platformChanged\", \n      \"line\", \n      \"lineConfirmed\", \n      \"displayAs\", \n      \"gbttBookedArrival\", \n      \"realtimeArrival\", \n      \"realtimeArrivalActual\", \n      \"realtimeGbttArrivalLateness\"\n    }\n  ), \n  #\"Removed Other Columns\" = Table.SelectColumns(\n    #\"Expanded Column2\", \n    {\"crs\", \"realtimeDeparture\", \"platform\", \"realtimeArrival\"}\n  ), \n  #\"Added Custom\" = Table.AddColumn(\n    #\"Removed Other Columns\", \n    \"Departure\", \n    each if [realtimeDeparture] is null then [realtimeArrival] else [realtimeDeparture]\n  ), \n  #\"Removed Other Columns1\" = Table.SelectColumns(#\"Added Custom\", {\"crs\", \"platform\", \"Departure\"}), \n  #\"Changed Type\" = Table.TransformColumnTypes(\n    #\"Removed Other Columns1\", \n    {{\"Departure\", type time}}\n  ), \n  #\"Added Index\" = Table.AddIndexColumn(#\"Changed Type\", \"Index\", 1, 1, Int64.Type), \n  #\"Renamed Columns\" = Table.RenameColumns(#\"Added Index\", {{\"Index\", \"StationOrder\"}})\nin\n  #\"Renamed Columns\"\n\n  in\n  Source;\r\n","connectionOverrides":[{"path":"https://api.rtt.io/api/v1/json/service/","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://api.rtt.io/api/v1/json/service/\"}","audience":null},{"path":"https://api.rtt.io/api/v1/json/search/","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://api.rtt.io/api/v1/json/search/\"}","audience":null},{"path":"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/TrainServices.xlsx","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/TrainServices.xlsx\"}","audience":null},{"path":"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/table-6329-station-attributes-for-all-mainline-stations.xlsx","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://qnrl.sharepoint.com/sites/PowerBITeam/Shared%20Documents/General/Internal%20Projects/ChooChooTrain/table-6329-station-attributes-for-all-mainline-stations.xlsx\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"id\":\"6abf0812-58eb-414a-838e-f41cb5635848\",\"name\":\"Parameters\",\"description\":\"\",\"parentId\":null,\"order\":0},{\"id\":\"59e20448-04db-4441-9db2-547d549dbc05\",\"name\":\"CheckQuery\",\"description\":\"\",\"parentId\":null,\"order\":2},{\"id\":\"f46495b9-7e51-46e3-9c6c-f2bef65af4e5\",\"name\":\"Functions\",\"description\":\"\",\"parentId\":null,\"order\":1},{\"id\":\"05c9da4c-0131-41ab-a8d1-34033956358e\",\"name\":\"BaseQuery\",\"description\":\"\",\"parentId\":null,\"order\":3},{\"id\":\"bc4a2699-cbfd-4fd8-b491-4f097ea333f6\",\"name\":\"Other Queries\",\"description\":\"\",\"parentId\":null,\"order\":4}]"}],"entities":[{"$type":"LocalEntity","name":"CurrentTimePlusOne","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"CurrentTimePlusOne.csv"},"attributes":[{"name":"Value","dataType":"time"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2025-01-15T10:22:36.6896309+00:00","location":"https://wabinoeucdsap1.blob.core.windows.net:443/6af6602d-d9d0-4553-ad44-a2f45b753c8a/CurrentTimePlusOne.csv?snapshot=2025-01-15T10%3A22%3A36.6811679Z"}]},{"$type":"LocalEntity","name":"TodaysDate","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"TodaysDate.csv"},"attributes":[{"name":"Date","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2025-01-15T10:22:37.9552529+00:00","location":"https://wabinoeucdsap1.blob.core.windows.net:443/6af6602d-d9d0-4553-ad44-a2f45b753c8a/TodaysDate.csv?snapshot=2025-01-15T10%3A22%3A37.5254652Z"}]},{"$type":"LocalEntity","name":"ServicesNextHrSpreadsheet","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"ServicesNextHrSpreadsheet.csv"},"attributes":[{"name":"StartStation","dataType":"string"},{"name":"DestinationStation","dataType":"string"},{"name":"Start","dataType":"string"},{"name":"Destination","dataType":"string"},{"name":"realtimeDeparture","dataType":"string"},{"name":"platform","dataType":"string"},{"name":"services.serviceUid","dataType":"string"},{"name":"Index","dataType":"int64"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2025-01-15T10:22:40.1427495+00:00","location":"https://wabinoeucdsap1.blob.core.windows.net:443/6af6602d-d9d0-4553-ad44-a2f45b753c8a/ServicesNextHrSpreadsheet.csv?snapshot=2025-01-15T10%3A22%3A40.0225108Z"}]},{"$type":"LocalEntity","name":"ServicesNextHrSpreadsheetViaStationsV2","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"ServicesNextHrSpreadsheetViaStationsV2.csv"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"}],"attributes":[{"name":"Start","dataType":"string"},{"name":"Destination","dataType":"string"},{"name":"StationDeparture","dataType":"time"},{"name":"platform","dataType":"string"},{"name":"services.serviceUid","dataType":"string"},{"name":"Index","dataType":"int64"},{"name":"TodaysDate","dataType":"string"},{"name":"URL","dataType":"string"},{"name":"relPath","dataType":"string"},{"name":"crs","dataType":"string"},{"name":"platform.1","dataType":"string"},{"name":"Departure","dataType":"time"},{"name":"StationOrder","dataType":"int64"},{"name":"Station","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2025-01-15T10:22:43.752134+00:00","location":"https://wabinoeucdsap1.blob.core.windows.net:443/6af6602d-d9d0-4553-ad44-a2f45b753c8a/ServicesNextHrSpreadsheetViaStationsV2.csv?snapshot=2025-01-15T10%3A22%3A43.7441835Z"}]},{"$type":"LocalEntity","name":"Station_attributes","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Station_attributes.csv"},"attributes":[{"name":"Station name","dataType":"string"},{"name":"Three Letter Code","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2025-01-15T10:22:39.7364982+00:00","location":"https://wabinoeucdsap1.blob.core.windows.net:443/6af6602d-d9d0-4553-ad44-a2f45b753c8a/Station_attributes.csv?snapshot=2025-01-15T10%3A22%3A39.6262489Z"}]}]}